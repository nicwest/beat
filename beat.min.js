var beat={init:function(){if(window.addEventListener){window.addEventListener("load",beat.setup,false)}else{window.attachEvent("onload",beat.beat.setup)}this.readyFuncs.push(function(){var a=document.getElementsByTagName("body")[0];a.className=a.className+" beat"})},storage:{},settings:{ident:"thebeat123",loadClass:"beat"},readyFuncs:[],first:false,timer:false,counter:0,setup:function(){if(localStorage.beat){beat.get()}else{var a={};beat.storage=a;beat.set()}if(beat.settings.ident in beat.storage){if(beat.storage[beat.settings.ident]>1){beat.first=true;beat.storage[beat.settings.ident]=0;beat.set()}}else{beat.first=true;beat.storage[beat.settings.ident]=0;beat.set()}beat.timer=window.setInterval(beat.check,100)},check:function(){beat.get();var a=beat.storage[beat.settings.ident];if(a==0&&!beat.first){window.clearInterval(beat.timer);beat.storage[beat.settings.ident]=1;beat.set();beat.timer=window.setInterval(beat.sync,10)}if(a==1&&beat.first){window.clearInterval(beat.timer);beat.timer=window.setInterval(beat.sync,10)}},sync:function(){beat.get();var a=beat.storage[beat.settings.ident];if(a==1&&beat.first){beat.storage[beat.settings.ident]=2;beat.set()}else{if(a==3&&beat.first){beat.storage[beat.settings.ident]=2;beat.set();beat.counter++}else{if(a==2&&!beat.first){beat.storage[beat.settings.ident]=3;beat.set();beat.counter++}else{beat.counter=0}}}if(beat.counter>3||a==4){window.clearInterval(beat.timer);beat.storage[beat.settings.ident]=4;beat.set();beat.execute()}},get:function(){beat.storage=JSON.parse(localStorage.beat)},set:function(){localStorage.beat=JSON.stringify(beat.storage)},execute:function(){for(i=0;i<beat.readyFuncs.length;i++){beat.readyFuncs[i].apply()}},ready:function(a){if(typeof(a)!=="undefined"){beat.readyFuncs.push(a)}}};